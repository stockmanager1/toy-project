{"cells":[{"cell_type":"markdown","metadata":{"id":"bHz7OlaIuPQT"},"source":["일반적으로 데이터셋이 클수록, AutoGluon과 같은 모델 선택 및 하이퍼파라미터 최적화를 자동화하는 AutoML 시스템이 더 효과적일 가능성이 높습니다. 이는 데이터셋의 크기가 모델 성능에 중요한 역할을 하는 경우에 특히 그렇습니다.\n","\n","AutoGluon은 다양한 모델 아키텍처와 하이퍼파라미터 설정을 자동으로 선택하고 최적화하는 데 있어서, 큰 데이터셋에서도 잘 작동합니다. 반면 Supervised AutoML은 미리 정의된 모델 아키텍처와 하이퍼파라미터 공간을 기반으로 최적화를 수행하므로, 상대적으로 작은 데이터셋에서 더 적합할 수 있습니다.\n","\n","하지만, 이 역시도 데이터셋의 특성에 따라 달라질 수 있으므로, 데이터셋과 문제의 특성을 고려하여 두 시스템을 비교하여 결정하는 것이 좋습니다."]},{"cell_type":"code","execution_count":1,"metadata":{"executionInfo":{"elapsed":2033,"status":"ok","timestamp":1678600337954,"user":{"displayName":"김영일","userId":"05579052707850277409"},"user_tz":-540},"id":"7J024t8Ydkbs"},"outputs":[],"source":["import pandas as pd\n","import random\n","import os\n","import numpy as np\n","\n","from sklearn.preprocessing import LabelEncoder\n","from sklearn.linear_model import LinearRegression\n","\n","from sklearn.model_selection import train_test_split\n","\n","import seaborn as sns\n","import matplotlib as mpl\n","import matplotlib.pyplot as plt\n","\n","from sklearn.model_selection import train_test_split\n","\n","from sklearn.metrics import mean_absolute_error"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17367,"status":"ok","timestamp":1678600355315,"user":{"displayName":"김영일","userId":"05579052707850277409"},"user_tz":-540},"id":"dDNFLKzgrOx5","outputId":"68286ded-66ff-45b0-c518-c9c730a16b98"},"outputs":[{"name":"stdout","output_type":"stream","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting mljar-supervised\n","  Downloading mljar-supervised-0.11.5.tar.gz (112 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m112.7/112.7 KB\u001b[0m \u001b[31m8.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: numpy\u003e=1.19.5 in /usr/local/lib/python3.9/dist-packages (from mljar-supervised) (1.22.4)\n","Requirement already satisfied: pandas\u003e=1.2.0 in /usr/local/lib/python3.9/dist-packages (from mljar-supervised) (1.3.5)\n","Requirement already satisfied: scipy\u003e=1.6.1 in /usr/local/lib/python3.9/dist-packages (from mljar-supervised) (1.10.1)\n","Requirement already satisfied: scikit-learn\u003e=1.0 in /usr/local/lib/python3.9/dist-packages (from mljar-supervised) (1.2.1)\n","Requirement already satisfied: xgboost\u003e=1.3.3 in /usr/local/lib/python3.9/dist-packages (from mljar-supervised) (1.7.4)\n","Collecting lightgbm\u003e=3.0.0\n","  Downloading lightgbm-3.3.5-py3-none-manylinux1_x86_64.whl (2.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.0/2.0 MB\u001b[0m \u001b[31m64.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting catboost\u003e=0.24.4\n","  Downloading catboost-1.1.1-cp39-none-manylinux1_x86_64.whl (76.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m76.6/76.6 MB\u001b[0m \u001b[31m8.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: joblib\u003e=1.0.1 in /usr/local/lib/python3.9/dist-packages (from mljar-supervised) (1.2.0)\n","Requirement already satisfied: tabulate\u003e=0.8.7 in /usr/local/lib/python3.9/dist-packages (from mljar-supervised) (0.8.10)\n","Requirement already satisfied: matplotlib\u003e=3.2.2 in /usr/local/lib/python3.9/dist-packages (from mljar-supervised) (3.5.3)\n","Collecting dtreeviz\u003e=2.0.0\n","  Downloading dtreeviz-2.2.0-py3-none-any.whl (90 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m90.5/90.5 KB\u001b[0m \u001b[31m10.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting shap\u003e=0.36.0\n","  Downloading shap-0.41.0-cp39-cp39-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (572 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m572.4/572.4 KB\u001b[0m \u001b[31m42.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: seaborn\u003e=0.11.1 in /usr/local/lib/python3.9/dist-packages (from mljar-supervised) (0.11.2)\n","Requirement already satisfied: wordcloud\u003e=1.8.1 in /usr/local/lib/python3.9/dist-packages (from mljar-supervised) (1.8.2.2)\n","Collecting category_encoders\u003e=2.2.2\n","  Downloading category_encoders-2.6.0-py2.py3-none-any.whl (81 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m81.2/81.2 KB\u001b[0m \u001b[31m9.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting optuna\u003e=2.7.0\n","  Downloading optuna-3.1.0-py3-none-any.whl (365 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m365.3/365.3 KB\u001b[0m \u001b[31m30.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting scikit-plot==0.3.7\n","  Downloading scikit_plot-0.3.7-py3-none-any.whl (33 kB)\n","Requirement already satisfied: markdown in /usr/local/lib/python3.9/dist-packages (from mljar-supervised) (3.4.1)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.9/dist-packages (from mljar-supervised) (4.5.0)\n","Requirement already satisfied: plotly in /usr/local/lib/python3.9/dist-packages (from catboost\u003e=0.24.4-\u003emljar-supervised) (5.5.0)\n","Requirement already satisfied: six in /usr/local/lib/python3.9/dist-packages (from catboost\u003e=0.24.4-\u003emljar-supervised) (1.15.0)\n","Requirement already satisfied: graphviz in /usr/local/lib/python3.9/dist-packages (from catboost\u003e=0.24.4-\u003emljar-supervised) (0.10.1)\n","Requirement already satisfied: statsmodels\u003e=0.9.0 in /usr/local/lib/python3.9/dist-packages (from category_encoders\u003e=2.2.2-\u003emljar-supervised) (0.13.5)\n","Requirement already satisfied: patsy\u003e=0.5.1 in /usr/local/lib/python3.9/dist-packages (from category_encoders\u003e=2.2.2-\u003emljar-supervised) (0.5.3)\n","Requirement already satisfied: pytest in /usr/local/lib/python3.9/dist-packages (from dtreeviz\u003e=2.0.0-\u003emljar-supervised) (3.6.4)\n","Collecting colour\n","  Downloading colour-0.1.5-py2.py3-none-any.whl (23 kB)\n","Requirement already satisfied: wheel in /usr/local/lib/python3.9/dist-packages (from lightgbm\u003e=3.0.0-\u003emljar-supervised) (0.38.4)\n","Requirement already satisfied: pillow\u003e=6.2.0 in /usr/local/lib/python3.9/dist-packages (from matplotlib\u003e=3.2.2-\u003emljar-supervised) (8.4.0)\n","Requirement already satisfied: packaging\u003e=20.0 in /usr/local/lib/python3.9/dist-packages (from matplotlib\u003e=3.2.2-\u003emljar-supervised) (23.0)\n","Requirement already satisfied: kiwisolver\u003e=1.0.1 in /usr/local/lib/python3.9/dist-packages (from matplotlib\u003e=3.2.2-\u003emljar-supervised) (1.4.4)\n","Requirement already satisfied: cycler\u003e=0.10 in /usr/local/lib/python3.9/dist-packages (from matplotlib\u003e=3.2.2-\u003emljar-supervised) (0.11.0)\n","Requirement already satisfied: python-dateutil\u003e=2.7 in /usr/local/lib/python3.9/dist-packages (from matplotlib\u003e=3.2.2-\u003emljar-supervised) (2.8.2)\n","Requirement already satisfied: fonttools\u003e=4.22.0 in /usr/local/lib/python3.9/dist-packages (from matplotlib\u003e=3.2.2-\u003emljar-supervised) (4.39.0)\n","Requirement already satisfied: pyparsing\u003e=2.2.1 in /usr/local/lib/python3.9/dist-packages (from matplotlib\u003e=3.2.2-\u003emljar-supervised) (3.0.9)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.9/dist-packages (from optuna\u003e=2.7.0-\u003emljar-supervised) (4.65.0)\n","Collecting alembic\u003e=1.5.0\n","  Downloading alembic-1.10.2-py3-none-any.whl (212 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m212.2/212.2 KB\u001b[0m \u001b[31m21.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting cmaes\u003e=0.9.1\n","  Downloading cmaes-0.9.1-py3-none-any.whl (21 kB)\n","Collecting colorlog\n","  Downloading colorlog-6.7.0-py2.py3-none-any.whl (11 kB)\n","Requirement already satisfied: sqlalchemy\u003e=1.3.0 in /usr/local/lib/python3.9/dist-packages (from optuna\u003e=2.7.0-\u003emljar-supervised) (1.4.46)\n","Requirement already satisfied: PyYAML in /usr/local/lib/python3.9/dist-packages (from optuna\u003e=2.7.0-\u003emljar-supervised) (6.0)\n","Requirement already satisfied: pytz\u003e=2017.3 in /usr/local/lib/python3.9/dist-packages (from pandas\u003e=1.2.0-\u003emljar-supervised) (2022.7.1)\n","Requirement already satisfied: threadpoolctl\u003e=2.0.0 in /usr/local/lib/python3.9/dist-packages (from scikit-learn\u003e=1.0-\u003emljar-supervised) (3.1.0)\n","Requirement already satisfied: cloudpickle in /usr/local/lib/python3.9/dist-packages (from shap\u003e=0.36.0-\u003emljar-supervised) (2.2.1)\n","Requirement already satisfied: numba in /usr/local/lib/python3.9/dist-packages (from shap\u003e=0.36.0-\u003emljar-supervised) (0.56.4)\n","Collecting slicer==0.0.7\n","  Downloading slicer-0.0.7-py3-none-any.whl (14 kB)\n","Requirement already satisfied: importlib-metadata\u003e=4.4 in /usr/local/lib/python3.9/dist-packages (from markdown-\u003emljar-supervised) (6.0.0)\n","Collecting Mako\n","  Downloading Mako-1.2.4-py3-none-any.whl (78 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m78.7/78.7 KB\u001b[0m \u001b[31m8.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: zipp\u003e=0.5 in /usr/local/lib/python3.9/dist-packages (from importlib-metadata\u003e=4.4-\u003emarkdown-\u003emljar-supervised) (3.15.0)\n","Requirement already satisfied: greenlet!=0.4.17 in /usr/local/lib/python3.9/dist-packages (from sqlalchemy\u003e=1.3.0-\u003eoptuna\u003e=2.7.0-\u003emljar-supervised) (2.0.2)\n","Requirement already satisfied: llvmlite\u003c0.40,\u003e=0.39.0dev0 in /usr/local/lib/python3.9/dist-packages (from numba-\u003eshap\u003e=0.36.0-\u003emljar-supervised) (0.39.1)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.9/dist-packages (from numba-\u003eshap\u003e=0.36.0-\u003emljar-supervised) (57.4.0)\n","Requirement already satisfied: tenacity\u003e=6.2.0 in /usr/local/lib/python3.9/dist-packages (from plotly-\u003ecatboost\u003e=0.24.4-\u003emljar-supervised) (8.2.2)\n","Requirement already satisfied: pluggy\u003c0.8,\u003e=0.5 in /usr/local/lib/python3.9/dist-packages (from pytest-\u003edtreeviz\u003e=2.0.0-\u003emljar-supervised) (0.7.1)\n","Requirement already satisfied: more-itertools\u003e=4.0.0 in /usr/local/lib/python3.9/dist-packages (from pytest-\u003edtreeviz\u003e=2.0.0-\u003emljar-supervised) (9.1.0)\n","Requirement already satisfied: atomicwrites\u003e=1.0 in /usr/local/lib/python3.9/dist-packages (from pytest-\u003edtreeviz\u003e=2.0.0-\u003emljar-supervised) (1.4.1)\n","Requirement already satisfied: py\u003e=1.5.0 in /usr/local/lib/python3.9/dist-packages (from pytest-\u003edtreeviz\u003e=2.0.0-\u003emljar-supervised) (1.11.0)\n","Requirement already satisfied: attrs\u003e=17.4.0 in /usr/local/lib/python3.9/dist-packages (from pytest-\u003edtreeviz\u003e=2.0.0-\u003emljar-supervised) (22.2.0)\n","Requirement already satisfied: MarkupSafe\u003e=0.9.2 in /usr/local/lib/python3.9/dist-packages (from Mako-\u003ealembic\u003e=1.5.0-\u003eoptuna\u003e=2.7.0-\u003emljar-supervised) (2.1.2)\n","Building wheels for collected packages: mljar-supervised\n","  Building wheel for mljar-supervised (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for mljar-supervised: filename=mljar_supervised-0.11.5-py3-none-any.whl size=147063 sha256=e94af6230dfee0bc396f09cd92b5b44bf980017196bbb72032b5329072a4342a\n","  Stored in directory: /root/.cache/pip/wheels/62/ed/f2/9a70a649613cf977a8b1e39ce373d14290a135fa309c1f1638\n","Successfully built mljar-supervised\n","Installing collected packages: colour, slicer, Mako, colorlog, cmaes, alembic, shap, scikit-plot, optuna, lightgbm, dtreeviz, catboost, category_encoders, mljar-supervised\n","  Attempting uninstall: lightgbm\n","    Found existing installation: lightgbm 2.2.3\n","    Uninstalling lightgbm-2.2.3:\n","      Successfully uninstalled lightgbm-2.2.3\n","Successfully installed Mako-1.2.4 alembic-1.10.2 catboost-1.1.1 category_encoders-2.6.0 cmaes-0.9.1 colorlog-6.7.0 colour-0.1.5 dtreeviz-2.2.0 lightgbm-3.3.5 mljar-supervised-0.11.5 optuna-3.1.0 scikit-plot-0.3.7 shap-0.41.0 slicer-0.0.7\n"]}],"source":["!pip install mljar-supervised"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":24580,"status":"ok","timestamp":1678600379890,"user":{"displayName":"김영일","userId":"05579052707850277409"},"user_tz":-540},"id":"Ifkxf7oKdpmQ","outputId":"415aad4f-c518-4529-a52b-f6733929202e"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/gdrive/\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/gdrive/')"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":831,"status":"ok","timestamp":1678600380716,"user":{"displayName":"김영일","userId":"05579052707850277409"},"user_tz":-540},"id":"6R4XyMK8dy5P"},"outputs":[],"source":["!unzip -qq \"/content/gdrive/MyDrive/open (1).zip\""]},{"cell_type":"code","execution_count":5,"metadata":{"executionInfo":{"elapsed":427,"status":"ok","timestamp":1678600381140,"user":{"displayName":"김영일","userId":"05579052707850277409"},"user_tz":-540},"id":"IIm0qIAkd0UK"},"outputs":[],"source":["train_df = pd.read_csv('./train.csv')\n","test_df = pd.read_csv('./test.csv')"]},{"cell_type":"code","execution_count":6,"metadata":{"executionInfo":{"elapsed":17055,"status":"ok","timestamp":1678600398192,"user":{"displayName":"김영일","userId":"05579052707850277409"},"user_tz":-540},"id":"rakV1JRSsL8y"},"outputs":[],"source":["from supervised.automl import AutoML"]},{"cell_type":"code","execution_count":7,"metadata":{"executionInfo":{"elapsed":443,"status":"ok","timestamp":1678600398630,"user":{"displayName":"김영일","userId":"05579052707850277409"},"user_tz":-540},"id":"oPBKuhlH6vS0"},"outputs":[],"source":["target_columns = train_df.filter(regex=\"새순\").columns\n","train_df[\"새순mean\"]   = train_df[target_columns].mean(axis=1)\n","train_df[\"새순std\"]    = train_df[target_columns].std(axis=1)\n","train_df[\"새순diff\"] = train_df[\"2022-11-28 새순\"] - train_df[\"2022-09-01 새순\"]\n","train_df[\"새순min\"]    = train_df[target_columns].min(axis=1)\n","train_df[\"새순max\"]    = train_df[target_columns].max(axis=1)\n","\n","test_df[\"새순mean\"]   = test_df[target_columns].mean(axis=1)\n","test_df[\"새순std\"]    = test_df[target_columns].std(axis=1)\n","test_df[\"새순diff\"]   = test_df[\"2022-11-28 새순\"] - test_df[\"2022-09-01 새순\"]\n","test_df[\"새순min\"]    = test_df[target_columns].min(axis=1)\n","test_df[\"새순max\"]    = test_df[target_columns].max(axis=1)"]},{"cell_type":"code","execution_count":8,"metadata":{"executionInfo":{"elapsed":332,"status":"ok","timestamp":1678600398961,"user":{"displayName":"김영일","userId":"05579052707850277409"},"user_tz":-540},"id":"oPib_fDO6wWb"},"outputs":[],"source":["target_columns = train_df.filter(regex=\"엽록소\").columns\n","train_df[\"mean_1\"]   = train_df[target_columns].mean(axis=1)\n","train_df[\"std_1\"]    = train_df[target_columns].std(axis=1)\n","train_df[\"diff_1\"] = train_df[\"2022-11-28 엽록소\"] - train_df[\"2022-09-01 엽록소\"]\n","train_df[\"min_1\"]    = train_df[target_columns].min(axis=1)\n","train_df[\"max_1\"]    = train_df[target_columns].max(axis=1)\n","\n","target_columns = test_df.filter(regex=\"엽록소\").columns\n","test_df[\"mean_1\"]   = test_df[target_columns].mean(axis=1)\n","test_df[\"std_1\"]    = test_df[target_columns].std(axis=1)\n","test_df[\"diff_1\"]   = test_df[\"2022-11-28 엽록소\"] - test_df[\"2022-09-01 엽록소\"]\n","test_df[\"min_1\"]    = test_df[target_columns].min(axis=1)\n","test_df[\"max_1\"]    = test_df[target_columns].max(axis=1)"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5366,"status":"ok","timestamp":1678600404322,"user":{"displayName":"김영일","userId":"05579052707850277409"},"user_tz":-540},"id":"ZMF25OOuX9c1","outputId":"de7de95c-066c-419d-f6dc-1c2a2e38c98f"},"outputs":[{"name":"stderr","output_type":"stream","text":["\u003cipython-input-9-db2c539c7ada\u003e:12: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","\u003cipython-input-9-db2c539c7ada\u003e:16: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n"]}],"source":["def calculate_surface_area(h, w):\n","    \"\"\"\n","    수고와 수관폭평균을 입력받아 수면적을 계산하여 반환하는 함수\n","    \"\"\"\n","    surface_area = h * w\n","    return surface_area\n","\n","train_df['수면적'] = 0\n","test_df['수면적'] = 0\n","\n","for i in range(2207):\n","  train_df['수면적'][i] = calculate_surface_area(train_df['수고(m)'][i],train_df['수관폭평균'][i])\n","\n","\n","for i in range(2208):\n","  test_df['수면적'][i] = calculate_surface_area(test_df['수고(m)'][i],test_df['수관폭평균'][i])"]},{"cell_type":"code","execution_count":13,"metadata":{"executionInfo":{"elapsed":346,"status":"ok","timestamp":1678600411863,"user":{"displayName":"김영일","userId":"05579052707850277409"},"user_tz":-540},"id":"lv-IQdKHsSY7"},"outputs":[],"source":["automl = AutoML(mode=\"Compete\", eval_metric='mae',total_time_limit=3600*3)"]},{"cell_type":"code","execution_count":14,"metadata":{"executionInfo":{"elapsed":3,"status":"ok","timestamp":1678600413172,"user":{"displayName":"김영일","userId":"05579052707850277409"},"user_tz":-540},"id":"j7n73K52kQWb"},"outputs":[],"source":["X_train = train_df.drop(['ID','착과량(int)'], axis=1)\n","y_train = train_df['착과량(int)']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"id":"9V-fs6r4smqz"},"outputs":[{"name":"stdout","output_type":"stream","text":["AutoML directory: AutoML_2\n","The task is regression with evaluation metric mae\n","AutoML will use algorithms: ['Decision Tree', 'Linear', 'Random Forest', 'Extra Trees', 'LightGBM', 'Xgboost', 'CatBoost', 'Neural Network', 'Nearest Neighbors']\n","AutoML will stack models\n","AutoML will ensemble available models\n","AutoML steps: ['adjust_validation', 'simple_algorithms', 'default_algorithms', 'not_so_random', 'golden_features', 'kmeans_features', 'insert_random_feature', 'features_selection', 'hill_climbing_1', 'hill_climbing_2', 'boost_on_errors', 'ensemble', 'stack', 'ensemble_stacked']\n","* Step adjust_validation will try to check up to 1 model\n","1_DecisionTree mae 31.350505 trained in 0.79 seconds\n","Adjust validation. Remove: 1_DecisionTree\n","Validation strategy: 10-fold CV Shuffle\n","* Step simple_algorithms will try to check up to 4 models\n","1_DecisionTree mae 32.079328 trained in 3.62 seconds\n","2_DecisionTree mae 31.09015 trained in 4.07 seconds\n","3_DecisionTree mae 31.122756 trained in 5.28 seconds\n","4_Linear mae 36.142309 trained in 5.61 seconds\n","* Step default_algorithms will try to check up to 6 models\n","5_Default_LightGBM mae 31.066734 trained in 46.59 seconds\n","6_Default_Xgboost mae 31.104551 trained in 45.03 seconds\n","7_Default_CatBoost mae 31.252687 trained in 66.81 seconds\n","8_Default_NeuralNetwork mae 36.552926 trained in 13.89 seconds\n","9_Default_RandomForest mae 29.692524 trained in 62.73 seconds\n","10_Default_ExtraTrees mae 29.993672 trained in 31.66 seconds\n","* Step not_so_random will try to check up to 54 models\n","20_LightGBM mae 30.457965 trained in 16.71 seconds\n","11_Xgboost mae 31.390051 trained in 61.04 seconds\n","29_CatBoost mae 31.548422 trained in 362.25 seconds\n","38_RandomForest mae 29.69962 trained in 51.17 seconds\n","47_ExtraTrees mae 30.180836 trained in 23.09 seconds\n","56_NeuralNetwork mae 113.597388 trained in 15.14 seconds\n","21_LightGBM mae 31.378656 trained in 20.21 seconds\n","12_Xgboost mae 32.271377 trained in 86.81 seconds\n","30_CatBoost mae 31.938214 trained in 172.45 seconds\n","39_RandomForest mae 30.316855 trained in 60.0 seconds\n","48_ExtraTrees mae 30.739319 trained in 35.87 seconds\n","57_NeuralNetwork mae 37.097122 trained in 17.69 seconds\n","22_LightGBM mae 31.388848 trained in 50.04 seconds\n","13_Xgboost mae 31.050582 trained in 23.94 seconds\n","31_CatBoost mae 31.299009 trained in 133.06 seconds\n","40_RandomForest mae 29.982361 trained in 120.24 seconds\n","49_ExtraTrees mae 29.83022 trained in 36.58 seconds\n","58_NeuralNetwork mae 100.275628 trained in 27.13 seconds\n","23_LightGBM mae 31.571247 trained in 74.32 seconds\n","14_Xgboost mae 30.358974 trained in 18.97 seconds\n","32_CatBoost mae 33.093037 trained in 128.96 seconds\n","41_RandomForest mae 29.963882 trained in 84.89 seconds\n","50_ExtraTrees mae 29.984121 trained in 30.68 seconds\n","59_NeuralNetwork mae 40.041996 trained in 23.34 seconds\n","24_LightGBM mae 31.128831 trained in 18.33 seconds\n","15_Xgboost mae 30.662816 trained in 21.61 seconds\n","33_CatBoost mae 31.993787 trained in 60.74 seconds\n","42_RandomForest mae 29.937511 trained in 97.65 seconds\n","51_ExtraTrees mae 29.864852 trained in 30.37 seconds\n","60_NeuralNetwork mae 37.01405 trained in 19.04 seconds\n","25_LightGBM mae 31.325369 trained in 36.4 seconds\n","16_Xgboost mae 30.42503 trained in 17.93 seconds\n","34_CatBoost mae 31.141156 trained in 35.37 seconds\n","43_RandomForest mae 30.090717 trained in 177.8 seconds\n","52_ExtraTrees mae 30.053031 trained in 51.26 seconds\n","61_NeuralNetwork mae 37.089306 trained in 26.92 seconds\n","26_LightGBM mae 31.075369 trained in 43.94 seconds\n","17_Xgboost mae 31.08292 trained in 66.08 seconds\n","35_CatBoost mae 31.560245 trained in 378.07 seconds\n","44_RandomForest mae 29.763571 trained in 71.19 seconds\n","53_ExtraTrees mae 29.800244 trained in 29.08 seconds\n","62_NeuralNetwork mae 36.289105 trained in 17.75 seconds\n","27_LightGBM mae 30.516831 trained in 27.97 seconds\n","18_Xgboost mae 30.695752 trained in 29.39 seconds\n","36_CatBoost mae 31.804273 trained in 120.12 seconds\n","45_RandomForest mae 29.75891 trained in 64.36 seconds\n","54_ExtraTrees mae 30.148038 trained in 31.71 seconds\n","63_NeuralNetwork mae 189.353774 trained in 20.86 seconds\n","28_LightGBM mae 30.321027 trained in 27.86 seconds\n","19_Xgboost mae 31.088665 trained in 90.63 seconds\n","37_CatBoost mae 31.42883 trained in 338.74 seconds\n","46_RandomForest mae 29.907203 trained in 84.48 seconds\n","55_ExtraTrees mae 29.839109 trained in 35.33 seconds\n","64_NeuralNetwork mae 37.015657 trained in 27.48 seconds\n","* Step golden_features will try to check up to 3 models\n","None 19\n","Add Golden Feature: 새순std_multiply_새순mean\n","Add Golden Feature: 2022-09-02 새순_multiply_2022-09-01 새순\n","Add Golden Feature: 새순max_sum_2022-09-02 새순\n","Add Golden Feature: 새순max_multiply_2022-09-02 새순\n","Add Golden Feature: 2022-09-02 새순_sum_2022-09-01 새순\n","Add Golden Feature: 2022-09-10 새순_multiply_2022-09-03 새순\n","Add Golden Feature: 2022-09-10 새순_sum_2022-09-03 새순\n","Add Golden Feature: 2022-09-07 새순_multiply_2022-09-01 새순\n","Add Golden Feature: 새순max_multiply_2022-09-07 새순\n","Add Golden Feature: 새순max_sum_2022-09-07 새순\n","Add Golden Feature: 2022-09-07 새순_sum_2022-09-01 새순\n","Add Golden Feature: 새순max_sum_2022-09-09 새순\n","Add Golden Feature: 2022-09-09 새순_sum_2022-09-01 새순\n","Add Golden Feature: 2022-09-09 새순_multiply_2022-09-01 새순\n","Add Golden Feature: 새순max_multiply_2022-09-09 새순\n","Add Golden Feature: 2022-09-06 새순_multiply_2022-09-04 새순\n","Add Golden Feature: 2022-09-06 새순_sum_2022-09-04 새순\n","Add Golden Feature: 2022-09-09 새순_sum_2022-09-04 새순\n","Add Golden Feature: 2022-09-09 새순_multiply_2022-09-04 새순\n","Created 19 Golden Features in 152.58 seconds.\n","9_Default_RandomForest_GoldenFeatures mae 29.559644 trained in 244.29 seconds\n","38_RandomForest_GoldenFeatures mae 29.588745 trained in 62.6 seconds\n","45_RandomForest_GoldenFeatures mae 29.496712 trained in 69.21 seconds\n","* Step kmeans_features will try to check up to 3 models\n"]},{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n"]},{"name":"stdout","output_type":"stream","text":["9_Default_RandomForest_KMeansFeatures mae 29.812288 trained in 109.11 seconds\n"]},{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n"]},{"name":"stdout","output_type":"stream","text":["38_RandomForest_KMeansFeatures mae 29.787512 trained in 70.83 seconds\n"]},{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n","/usr/local/lib/python3.9/dist-packages/sklearn/cluster/_kmeans.py:870: FutureWarning: The default value of `n_init` will change from 3 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning\n"]},{"name":"stdout","output_type":"stream","text":["45_RandomForest_KMeansFeatures mae 29.715203 trained in 80.14 seconds\n","* Step insert_random_feature will try to check up to 1 model\n","45_RandomForest_GoldenFeatures_RandomFeature mae 29.482872 trained in 198.32 seconds\n"]},{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.9/dist-packages/supervised/utils/additional_metrics.py:558: UserWarning: Glyph 49352 (\\N{HANGUL SYLLABLE SAE}) missing from current font.\n","/usr/local/lib/python3.9/dist-packages/supervised/utils/additional_metrics.py:558: UserWarning: Glyph 49692 (\\N{HANGUL SYLLABLE SUN}) missing from current font.\n","/usr/local/lib/python3.9/dist-packages/supervised/utils/additional_metrics.py:564: UserWarning: Glyph 49352 (\\N{HANGUL SYLLABLE SAE}) missing from current font.\n","/usr/local/lib/python3.9/dist-packages/supervised/utils/additional_metrics.py:564: UserWarning: Glyph 49692 (\\N{HANGUL SYLLABLE SUN}) missing from current font.\n"]},{"name":"stdout","output_type":"stream","text":["Drop features ['2022-09-02 새순_multiply_2022-09-01 새순', '2022-09-10 새순', '2022-09-07 새순', '2022-09-07 새순_multiply_2022-09-01 새순', '새순max_sum_2022-09-09 새순', '2022-09-09 새순_sum_2022-09-01 새순', '2022-09-01 새순', '2022-09-08 새순', '2022-09-16 새순', '2022-09-12 새순', '2022-09-24 새순', '2022-09-09 새순', '2022-09-13 새순', '2022-10-06 새순', '2022-09-20 새순', '수관폭평균', '2022-09-21 새순', '2022-10-04 새순', '새순mean', '2022-09-15 새순', '2022-09-28 새순', '수관폭1(min)', '2022-10-21 새순', '2022-10-08 새순', '2022-10-24 새순', '2022-11-21 새순', '수관폭2(max)', 'random_feature', '2022-09-25 새순', '2022-10-26 새순', '2022-10-07 새순', 'diff_1', '수고(m)', '2022-10-14 새순', '2022-10-23 새순', '2022-10-10 새순', '2022-10-31 새순', '2022-11-19 엽록소', '2022-11-22 엽록소', '2022-09-19 새순', '2022-11-09 새순', '수면적', '2022-09-06 엽록소', '2022-09-03 엽록소', '2022-10-02 새순', '2022-11-02 새순', '2022-11-10 엽록소', '2022-09-13 엽록소', '2022-09-22 엽록소', 'mean_1', '2022-11-02 엽록소', '2022-11-08 엽록소', '2022-10-28 엽록소', '2022-11-05 엽록소', '2022-10-06 엽록소', '2022-10-29 엽록소', '2022-10-13 엽록소', '2022-11-12 엽록소', '2022-11-06 엽록소', '2022-10-02 엽록소', '2022-10-09 엽록소', '2022-09-12 엽록소', '2022-11-10 새순', '2022-09-14 엽록소', '2022-09-19 엽록소', '2022-11-11 엽록소', '2022-10-31 엽록소', '2022-10-23 엽록소', '2022-11-07 엽록소', '2022-11-01 새순', '새순min', '2022-10-03 엽록소', '2022-10-01 엽록소', '2022-11-23 엽록소', '2022-09-30 엽록소', '2022-10-04 엽록소', '2022-11-25 엽록소', 'min_1', '2022-10-05 엽록소', '2022-10-21 엽록소', '2022-10-16 엽록소', '2022-11-05 새순', '2022-11-22 새순', '2022-10-24 엽록소', '2022-11-13 새순', '2022-11-28 엽록소', '2022-11-23 새순', '2022-11-26 새순', '2022-11-24 새순', '2022-10-10 엽록소', '2022-11-19 새순', '2022-09-26 새순', '2022-10-17 엽록소', '2022-09-04 엽록소', '2022-10-27 엽록소', '2022-11-04 새순', '2022-09-07 엽록소', '2022-09-28 엽록소', '2022-09-26 엽록소', '2022-09-25 엽록소', '2022-09-09 엽록소', '2022-09-10 엽록소', '2022-10-08 엽록소', '2022-10-07 엽록소', '2022-09-21 엽록소', '2022-11-03 새순', '2022-11-11 새순', '2022-11-06 새순', '2022-11-14 새순', '2022-11-16 새순', '2022-10-18 새순', '2022-10-13 새순', '2022-11-28 새순', '2022-09-01 엽록소', '2022-11-13 엽록소', '2022-11-17 새순', '2022-10-27 새순', '2022-10-01 새순', '2022-11-18 새순', '2022-11-21 엽록소', '2022-10-12 엽록소', '2022-10-11 엽록소', '2022-11-20 새순', '2022-09-16 엽록소', '2022-11-26 엽록소', '2022-10-22 엽록소', '2022-09-27 엽록소', '2022-10-19 엽록소', '2022-10-15 새순', '2022-10-28 새순', '2022-11-09 엽록소', '2022-10-18 엽록소', '2022-09-15 엽록소', '2022-11-04 엽록소', '2022-09-05 엽록소', '2022-10-20 엽록소', '2022-09-23 엽록소', '2022-11-27 새순', '2022-11-07 새순', '2022-09-17 엽록소', '2022-10-17 새순', '2022-09-02 엽록소', '2022-10-05 새순', '2022-10-19 새순', '2022-11-20 엽록소', '2022-10-30 새순', '2022-09-18 엽록소', '2022-10-30 엽록소', '2022-11-08 새순', '2022-10-22 새순', '2022-10-29 새순', '2022-11-25 새순', '2022-10-25 엽록소', '2022-10-16 새순', '2022-10-14 엽록소', '2022-09-11 엽록소', '2022-11-16 엽록소', '2022-11-15 새순', '2022-09-17 새순', 'max_1', '2022-09-22 새순', '2022-11-14 엽록소', '2022-09-23 새순', '2022-10-11 새순', '2022-11-12 새순', '2022-09-08 엽록소', '2022-10-26 엽록소', '2022-09-27 새순', '2022-11-27 엽록소', '2022-10-09 새순', '2022-09-29 새순', '2022-09-20 엽록소', '2022-09-30 새순', '2022-10-25 새순', '2022-11-15 엽록소', '2022-09-24 엽록소', '2022-11-24 엽록소', '2022-11-03 엽록소', '2022-10-15 엽록소', '2022-11-01 엽록소', '2022-11-17 엽록소', '2022-11-18 엽록소', '2022-09-29 엽록소', '2022-09-18 새순', '2022-09-14 새순', '2022-10-03 새순', '2022-10-12 새순', '2022-10-20 새순']\n","* Step features_selection will try to check up to 6 models\n","45_RandomForest_GoldenFeatures_SelectedFeatures mae 29.433946 trained in 26.38 seconds\n","53_ExtraTrees_SelectedFeatures mae 30.069739 trained in 23.52 seconds\n","28_LightGBM_SelectedFeatures mae 29.967627 trained in 18.01 seconds\n","14_Xgboost_SelectedFeatures mae 29.882379 trained in 18.15 seconds\n","34_CatBoost_SelectedFeatures mae 30.186608 trained in 21.52 seconds\n","62_NeuralNetwork_SelectedFeatures mae 34.395521 trained in 18.79 seconds\n","* Step hill_climbing_1 will try to check up to 27 models\n","65_RandomForest_GoldenFeatures_SelectedFeatures mae 29.471059 trained in 26.67 seconds\n","66_RandomForest_GoldenFeatures_SelectedFeatures mae 29.532009 trained in 24.47 seconds\n","67_RandomForest_GoldenFeatures mae 29.522624 trained in 68.4 seconds\n","68_RandomForest_GoldenFeatures mae 29.566899 trained in 85.78 seconds\n","69_RandomForest_GoldenFeatures mae 29.636689 trained in 122.12 seconds\n","70_ExtraTrees mae 29.965766 trained in 30.51 seconds\n","71_ExtraTrees mae 29.782275 trained in 41.81 seconds\n","72_ExtraTrees mae 29.686117 trained in 40.59 seconds\n","73_ExtraTrees mae 30.070423 trained in 51.61 seconds\n","74_Xgboost_SelectedFeatures mae 29.889328 trained in 19.65 seconds\n","75_Xgboost_SelectedFeatures mae 29.874656 trained in 19.72 seconds\n","76_LightGBM_SelectedFeatures mae 30.039424 trained in 23.71 seconds\n","77_CatBoost_SelectedFeatures mae 30.112419 trained in 22.72 seconds\n","78_LightGBM mae 30.312173 trained in 31.47 seconds\n","79_Xgboost mae 30.304468 trained in 30.9 seconds\n","80_Xgboost mae 30.442638 trained in 30.9 seconds\n","81_Xgboost mae 30.577273 trained in 31.29 seconds\n","82_LightGBM mae 30.398626 trained in 31.31 seconds\n","83_CatBoost mae 31.544791 trained in 61.82 seconds\n","84_CatBoost mae 31.234429 trained in 72.83 seconds\n","85_CatBoost mae 31.564461 trained in 123.27 seconds\n","86_DecisionTree mae 55.170502 trained in 21.76 seconds\n","87_NeuralNetwork_SelectedFeatures mae 34.500333 trained in 26.64 seconds\n","88_NeuralNetwork_SelectedFeatures mae 34.330368 trained in 24.73 seconds\n","89_NeuralNetwork mae 37.089225 trained in 29.6 seconds\n","90_NeuralNetwork mae 36.204216 trained in 30.82 seconds\n","91_NeuralNetwork mae 40.906376 trained in 34.15 seconds\n","* Step hill_climbing_2 will try to check up to 25 models\n","92_RandomForest_GoldenFeatures_SelectedFeatures mae 29.433946 trained in 31.79 seconds\n","93_RandomForest_GoldenFeatures_SelectedFeatures mae 29.433946 trained in 33.75 seconds\n","94_RandomForest_GoldenFeatures_SelectedFeatures mae 29.471059 trained in 32.27 seconds\n","95_RandomForest_GoldenFeatures_SelectedFeatures mae 29.471059 trained in 30.96 seconds\n","96_RandomForest_GoldenFeatures mae 29.496712 trained in 80.37 seconds\n","97_RandomForest_GoldenFeatures mae 29.496712 trained in 79.71 seconds\n","98_ExtraTrees mae 29.911246 trained in 55.84 seconds\n","99_ExtraTrees mae 29.804651 trained in 51.63 seconds\n","100_ExtraTrees mae 29.782275 trained in 43.62 seconds\n","101_ExtraTrees mae 29.800244 trained in 41.55 seconds\n","102_Xgboost_SelectedFeatures mae 30.107289 trained in 24.54 seconds\n","103_Xgboost_SelectedFeatures mae 30.004925 trained in 27.3 seconds\n","104_Xgboost_SelectedFeatures mae 30.039737 trained in 23.48 seconds\n","105_LightGBM_SelectedFeatures mae 29.985296 trained in 27.59 seconds\n","106_LightGBM_SelectedFeatures mae 29.939933 trained in 25.48 seconds\n","107_CatBoost_SelectedFeatures mae 30.122388 trained in 26.49 seconds\n","108_CatBoost_SelectedFeatures mae 30.169236 trained in 28.35 seconds\n","109_LightGBM mae 30.302543 trained in 36.78 seconds\n","110_DecisionTree mae 31.09015 trained in 27.19 seconds\n","111_DecisionTree mae 31.122756 trained in 27.42 seconds\n","112_CatBoost mae 31.229949 trained in 51.85 seconds\n","113_DecisionTree mae 32.079328 trained in 29.23 seconds\n","114_NeuralNetwork_SelectedFeatures mae 34.432574 trained in 31.62 seconds\n","115_NeuralNetwork_SelectedFeatures mae 34.297238 trained in 30.66 seconds\n","116_NeuralNetwork_SelectedFeatures mae 34.181519 trained in 28.12 seconds\n","* Step boost_on_errors will try to check up to 1 model\n","92_RandomForest_GoldenFeatures_SelectedFeatures_BoostOnErrors mae 29.428627 trained in 35.65 seconds\n","* Step ensemble will try to check up to 1 model\n","Ensemble mae 29.225714 trained in 50.87 seconds\n","* Step stack will try to check up to 59 models\n","92_RandomForest_GoldenFeatures_SelectedFeatures_Stacked mae 29.629634 trained in 63.08 seconds\n","72_ExtraTrees_Stacked mae 29.792356 trained in 67.64 seconds\n","75_Xgboost_SelectedFeatures_Stacked mae 29.649668 trained in 34.82 seconds\n","106_LightGBM_SelectedFeatures_Stacked mae 29.875515 trained in 35.24 seconds\n","77_CatBoost_SelectedFeatures_Stacked mae 30.273728 trained in 58.58 seconds\n","116_NeuralNetwork_SelectedFeatures_Stacked mae 196.219761 trained in 39.67 seconds\n","45_RandomForest_GoldenFeatures_SelectedFeatures_Stacked mae 29.629634 trained in 70.64 seconds\n","71_ExtraTrees_Stacked mae 29.656409 trained in 56.58 seconds\n","14_Xgboost_SelectedFeatures_Stacked mae 29.605742 trained in 34.21 seconds\n","28_LightGBM_SelectedFeatures_Stacked mae 29.952293 trained in 38.16 seconds\n","107_CatBoost_SelectedFeatures_Stacked mae 30.542802 trained in 51.34 seconds\n","115_NeuralNetwork_SelectedFeatures_Stacked mae 155.264602 trained in 39.64 seconds\n","93_RandomForest_GoldenFeatures_SelectedFeatures_Stacked mae 29.629634 trained in 69.01 seconds\n","100_ExtraTrees_Stacked mae 29.656409 trained in 55.49 seconds\n","74_Xgboost_SelectedFeatures_Stacked mae 29.689521 trained in 35.56 seconds\n","105_LightGBM_SelectedFeatures_Stacked mae 30.039191 trained in 38.52 seconds\n","108_CatBoost_SelectedFeatures_Stacked mae 30.208887 trained in 47.3 seconds\n","88_NeuralNetwork_SelectedFeatures_Stacked mae 132.149663 trained in 46.98 seconds\n","94_RandomForest_GoldenFeatures_SelectedFeatures_Stacked mae 29.598685 trained in 53.74 seconds\n","53_ExtraTrees_Stacked mae 29.767935 trained in 55.35 seconds\n","103_Xgboost_SelectedFeatures_Stacked mae 29.713803 trained in 41.29 seconds\n","76_LightGBM_SelectedFeatures_Stacked mae 30.024042 trained in 40.3 seconds\n","34_CatBoost_SelectedFeatures_Stacked mae 30.13519 trained in 41.78 seconds\n","62_NeuralNetwork_SelectedFeatures_Stacked mae 151.801165 trained in 48.62 seconds\n","65_RandomForest_GoldenFeatures_SelectedFeatures_Stacked mae 29.598685 trained in 56.15 seconds\n","101_ExtraTrees_Stacked mae 29.767935 trained in 57.63 seconds\n","104_Xgboost_SelectedFeatures_Stacked mae 29.621711 trained in 37.87 seconds\n","109_LightGBM_Stacked mae 30.173918 trained in 51.64 seconds\n","34_CatBoost_Stacked mae 30.691544 trained in 69.5 seconds\n","114_NeuralNetwork_SelectedFeatures_Stacked mae 183.039488 trained in 39.27 seconds\n","95_RandomForest_GoldenFeatures_SelectedFeatures_Stacked mae 29.598685 trained in 54.93 seconds\n","99_ExtraTrees_Stacked mae 29.758028 trained in 67.56 seconds\n","102_Xgboost_SelectedFeatures_Stacked mae 29.766339 trained in 42.67 seconds\n","78_LightGBM_Stacked mae 30.25505 trained in 48.96 seconds\n","112_CatBoost_Stacked mae 30.725296 trained in 76.91 seconds\n","87_NeuralNetwork_SelectedFeatures_Stacked mae 167.620219 trained in 51.45 seconds\n","97_RandomForest_GoldenFeatures_Stacked mae 29.685023 trained in 123.84 seconds\n","49_ExtraTrees_Stacked mae 29.806424 trained in 73.11 seconds\n","79_Xgboost_Stacked mae 30.151281 trained in 48.33 seconds\n","28_LightGBM_Stacked mae 30.263364 trained in 58.47 seconds\n","84_CatBoost_Stacked mae 30.72778 trained in 86.48 seconds\n","90_NeuralNetwork_Stacked mae 121.060141 trained in 65.38 seconds\n","96_RandomForest_GoldenFeatures_Stacked mae 29.685023 trained in 121.47 seconds\n","55_ExtraTrees_Stacked mae 29.506825 trained in 57.87 seconds\n","14_Xgboost_Stacked mae 30.010977 trained in 51.97 seconds\n","82_LightGBM_Stacked mae 30.227677 trained in 46.28 seconds\n","7_Default_CatBoost_Stacked mae 30.628072 trained in 115.23 seconds\n","62_NeuralNetwork_Stacked mae 86.827826 trained in 69.37 seconds\n","45_RandomForest_GoldenFeatures_Stacked mae 29.685023 trained in 122.74 seconds\n","51_ExtraTrees_Stacked mae 29.790291 trained in 69.2 seconds\n","16_Xgboost_Stacked mae 30.259452 trained in 51.86 seconds\n","20_LightGBM_Stacked mae 30.295924 trained in 56.2 seconds\n","31_CatBoost_Stacked mae 30.784158 trained in 216.2 seconds\n","8_Default_NeuralNetwork_Stacked mae 110.022727 trained in 76.56 seconds\n","98_ExtraTrees_Stacked mae 29.725677 trained in 73.77 seconds\n","* Step ensemble_stacked will try to check up to 1 model\n","Ensemble_Stacked mae 28.962155 trained in 100.16 seconds\n","AutoML fit time: 10957.87 seconds\n","AutoML best model: Ensemble_Stacked\n"]},{"data":{"text/html":["\u003cstyle\u003e#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}\u003c/style\u003e\u003cdiv id=\"sk-container-id-1\" class=\"sk-top-container\"\u003e\u003cdiv class=\"sk-text-repr-fallback\"\u003e\u003cpre\u003eAutoML(eval_metric=\u0026#x27;mae\u0026#x27;, mode=\u0026#x27;Compete\u0026#x27;, total_time_limit=10800)\u003c/pre\u003e\u003cb\u003eIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. \u003cbr /\u003eOn GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\u003c/b\u003e\u003c/div\u003e\u003cdiv class=\"sk-container\" hidden\u003e\u003cdiv class=\"sk-item\"\u003e\u003cdiv class=\"sk-estimator sk-toggleable\"\u003e\u003cinput class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked\u003e\u003clabel for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\"\u003eAutoML\u003c/label\u003e\u003cdiv class=\"sk-toggleable__content\"\u003e\u003cpre\u003eAutoML(eval_metric=\u0026#x27;mae\u0026#x27;, mode=\u0026#x27;Compete\u0026#x27;, total_time_limit=10800)\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e"],"text/plain":["AutoML(eval_metric='mae', mode='Compete', total_time_limit=10800)"]},"execution_count":15,"metadata":{},"output_type":"execute_result"}],"source":["automl.fit(X_train, y_train)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hEbjI5Tsu2t-"},"outputs":[],"source":["pred = automl.predict(test_df)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FoZabqoHARwZ"},"outputs":[],"source":["\n","submit = pd.read_csv('./sample_submission.csv')\n","submit['착과량(int)']=np.array(pred)\n","\n","submit.head()\n","\n","submit.to_csv('./  no.csv', index=False)\n","     "]}],"metadata":{"colab":{"authorship_tag":"ABX9TyPWg5t4YRh3ANvSEnM85wVf","name":"","provenance":[{"file_id":"1vPZDsi-Y2L9dH1R0KfCSNcdX3pGOPCTy","timestamp":1678521422099}],"version":""},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}